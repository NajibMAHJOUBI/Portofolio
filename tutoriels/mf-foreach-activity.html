<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutoriel Microsoft Fabric - Activité ForEach | DataOps Learning</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/tutoriel.css">

</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-container">
            <div class="logo">
                <a href="index.html">
                    <i class="fas fa-cloud"></i>
                    <span>DataOps Learning</span>
                </a>
            </div>
            
            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <i class="fas fa-bars"></i>
            </button>
            
            <nav id="mainNav">
                <ul>
                    <li><a href="index.html">Accueil</a></li>
                    <li><a href="index.html#tutorials">Tutoriels</a></li>
                    <li><a href="index.html#about">À Propos</a></li>
                    <li><a href="index.html#contact">Contact</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Breadcrumb -->
    <div class="breadcrumb">
        <div class="container">
            <ul>
                <li><a href="index.html">Accueil</a></li>
                <li><a href="index.html#tutorials">Tutoriels</a></li>
                <li><a href="#">Microsoft Fabric</a></li>
                <li class="current">Activité ForEach</li>
            </ul>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <div class="tutorial-wrapper">
            <!-- Table des matières -->
            <aside class="toc-sidebar">
                <h3 class="toc-title">
                    <i class="fas fa-list-ul"></i>
                    Table des matières
                </h3>
                <ul class="toc-list">
                    <li><a href="#objectifs" class="active"><i class="fas fa-bullseye"></i>Objectifs du tutoriel</a></li>
                    <li><a href="#qu-est-ce-que-foreach"><i class="fas fa-question-circle"></i>Qu'est-ce que une activité ForEach ?</a></li>
                    <li><a href="#exemple-tutoriel"><i class="fas fa-video-camera"></i>Scénario de l'exemple</a></li>
                    <li><a href="#create-workspace"><i class="fas fa-database"></i>Création d'un Workspace</a></li>
                    <li><a href="#create-lakehouse"><i class="fas fa-lock"></i>Création d'un Lakehouse</a></li>
                    <li><a href="#create-pipeline"><i class="fas fa-check-circle"></i>Création d'un Pipeline</a></li>
                    <li><a href="#setup-pipeline"><i class="fas fa-list"></i>Paramétrage du Pipeline</a></li>
                    <li><a href="#add-foreach-activity"><i class="fas fa-add"></i>Ajout d'une activité ForEach</a></li>
                    <li><a href="#setup-foreach-activity"><i class="fas fa-list"></i>Paramétrage de l'activité ForEach</a></li>
                    <li><a href="#add-copy-data-activity"><i class="fas fa-add"></i>Ajout d'une activité Copy data</a></li>
                    <li><a href="#run-pipeline"><i class="fas fa-play-circle"></i>Exécution du Pipeline</a></li>
                </ul>
                
                <div style="margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid var(--gray-light);">
                    <p style="color: var(--gray); margin-bottom: 1rem;">
                        <i class="fas fa-clock"></i> Temps estimé: 25 minutes
                    </p>
                    <p style="color: var(--gray);">
                        <i class="fas fa-signal"></i> Niveau: Débutant
                    </p>
                </div>
            </aside>

            <!-- Contenu principal -->
            <main class="tutorial-content">
                <!-- En-tête -->
                <div class="tutorial-header">
                    <h1>Mise en place d'un flux de contrôle itératif</h1>
                    <h1>Activité ForEach</h1>
                    <span class="level-badge">Niveau Débutant</span>
                    
                    <div class="tutorial-meta">
                        <span class="meta-item">
                            <i class="far fa-calendar-alt"></i> Mis à jour: Février 2026
                        </span>
                        <span class="meta-item">
                            <i class="far fa-clock"></i> Durée: 10 min
                        </span>
                        <span class="meta-item">
                            <i class="fas fa-chart-bar"></i> Difficulté: Intermédiaire
                        </span>
                    </div>
                    
                    <div class="tech-stack">
                        <span class="tech-tag"><i class="fab fa-microsoft"></i> Microsoft Fabric</span>
                        <span class="tech-tag"><i class="fas fa-database"></i> Data Engineering</span>
                        <span class="tech-tag"><i class="fas fa-cloud"></i> Cloud</span>
                    </div>
                </div>

                <!-- Section: Objectifs du tutoriel -->
                <section id="objectifs" class="tutorial-section">
                    <h2><i class="fas fa-bullseye"></i> Objectifs du tutoriel</h2>

                    <p>Dans ce tutoriel, nous allons découvrir comment utiliser l'activité <b>ForEach</b> dans <b>Microsoft Fabric</b> pour créer un flux de contrôle itératif.              
                       À la fin de ce tutoriel, l'apprenant sera capable de concevoir, configurer et dépanner des pipelines dynamiques et évolutifs dans 
                       <b>Microsoft Fabric</b> en utilisant l'activité <b>ForEach</b> pour traiter des ensembles de données de manière itérative et concurrente. </p>
                

                    <ul style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                            <li style="margin-bottom: 0.8rem;">Identifier le rôle de l'activité <b>ForEach</b> dans l'orchestration de pipelines Fabric pour automatiser des tâches répétitives.</li>
                            <li style="margin-bottom: 0.8rem;">Configurer correctement les paramètres de base d'une activité <b>ForEach</b>, y compris le nombre maximum de lots pour l'exécution en parallèle.</li>
                            <li style="margin-bottom: 0.8rem;">Construire des expressions dynamiques complexes (à l'aide du langage d'expression de pipeline) pour manipuler les données avant qu'elles ne soient passées à l'itérateur.</li>
                            <li style="margin-bottom: 0.8rem;">Implémenter l'activité <b>ForEach</b> pour exécuter un sous-pipeline ou un ensemble d'activités sur chaque élément d'une collection.</li>
                            <li style="margin-bottom: 0.8rem;">Appliquer la variable système <i>@item()</i> pour référencer dynamiquement l'élément courant de l'itération dans les activités internes.</li>
                            <li style="margin-bottom: 0.8rem;">Interpréter les journaux d'exécution d'un pipeline contenant une activité <b>ForEach</b> pour identifier les itérations qui ont échoué.</li>
                    </ul>
                </section>

                <!-- Section: Qu'est-ce qu'une activité <b>ForEach</b> -->
                <section id="qu-est-ce-que-foreach" class="tutorial-section">
                    <h2><i class="fas fa-question-circle"></i> Qu'est-ce qu'une activité ForEach ?</h2>

                        <p>L'activité <b>ForEach</b> est un outil d'orchestration dans les pipelines <b>Microsoft Fabric</b>. 
                            Elle vous permet de créer des boucles pour itérer sur une collection d'éléments et d'exécuter un ensemble d'activités 
                            pour chacun de ces éléments.</p>

                        <p>Son fonctionnement est similaire à une structure de boucle <i>for</i> que l'on trouve classiquement 
                            dans les langages de programmation.</p>                            

                        <h3>Exemple d'utilisation de l'activité ForEach</h3>

                            <p>L'activité <b>ForEach</b> est principalement utilisée pour automatiser des tâches répétitives sur une liste d'éléments, comme :</p>

                            <ul style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                                    <li style="margin-bottom: 0.8rem;">Traiter une liste de fichiers ou de dossiers.</li>
                                    <li style="margin-bottom: 0.8rem;">Ingérer plusieurs tables d'une base de données source vers un <b>Lakehouse</b>.</li>
                                    <li style="margin-bottom: 0.8rem;">Exécuter le même ensemble de transformations sur différentes sources de données.</li>
                                    <li style="margin-bottom: 0.8rem;">Mettre en place des architectures "pilotées par les métadonnées" (metadata-driven), 
                                        où une table de configuration dicte les éléments à traiter dans la boucle.</li>
                            </ul>

                        <h3>Eléments principaux de l'activité ForEach</h3>
                                <p>Pour configurer une activité <b>ForEach</b>, il y a trois éléments principaux à prendre en compte :</p>

                                <ul style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                                        <li style="margin-bottom: 0.8rem;">La collection d'éléments (Items) : C'est la liste sur laquelle vous voulez itérer. 
                                            Elle doit être fournie sous forme de tableau JSON. 
                                            Cette liste peut être statique, mais elle est généralement dynamique : elle peut provenir d'une variable du pipeline, 
                                            de la sortie d'une autre activité (comme une activité Lookup ou Get Metadata), ou d'un paramètre.</li>
                                        <li style="margin-bottom: 0.8rem;">Les activités enfants : Ce sont les activités (Copie de données, Notebook, Script SQL, Procédure stockée, etc.) 
                                            qui seront exécutées pour chaque élément de la collection. Vous pouvez en ajouter une ou plusieurs.</li>
                                        <li style="margin-bottom: 0.8rem;">Le mode d'exécution : Vous pouvez choisir entre un mode séquentiel 
                                            (les itérations se succèdent une par une) ou un mode parallèle (plusieurs itérations s'exécutent en même temps pour accélérer le traitement). 
                                            En mode parallèle, vous pouvez contrôler le nombre maximal d'itérations simultanées (batch count) jusqu'à une limite de 50.</li>
                                </ul>               

                            <p>Pour référencer l'élément courant, il faudra utiliser @item() dans les activités enfants de votre <b>ForEach</b> qui acceptent du contenu dynamique.
                                Vous pouvez utiliser @item() dans n'importe quel champ d'une activité enfant </p>

                            <p>Cette activité est un élément clé pour créer des pipelines flexibles, évolutifs et capables de gérer des charges de travail complexes sans avoir 
                                à dupliquer manuellement les mêmes étapes pour chaque élément à traiter.</p>
                </section>

                <!-- Section: Scénario de l'exemple -->
                <section id="exemple-tutoriel" class="tutorial-section">
                    <h2><i class="fas fa-bucket"></i> Scénario de l'exemple</h2>
                
                        <p>Nous proposons un Scénario pédagogique avec l'API Zippopotam.us dont l'objectif est de montrer comment configurer l'activité <b>ForEach</b> 
                            pour traiter dynamiquement une liste d'entrées (villes) et comment stocker dans un <b>Lakehouse</b> les données de sortie de l'API.</p>

                        <p>L'idée est de créer un pipeline qui, pour une liste de villes (par exemple Paris, Londres, New York), interroge cette API pour obtenir des informations comme les codes postaux 
                        ou les lieux-dits associés.</p>

                        <ul style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                            <li style="margin-bottom: 0.8rem;"><b>Principe de l'API :</b> Elle est simple et ne nécessite pas d'authentification. 
                                Le format d'appel est https://api.zippopotam.us/[pays]/[ville]. 
                                Par exemple, pour Paris (France) : https://api.zippopotam.us/fr/paris.</li>
                            <li style="margin-bottom: 0.8rem;"><b>Rôle de l'activité ForEach :</b> Elle va itérer sur votre liste de villes. 
                                Pour chaque ville, elle lancera une activité Web (ou Copie de données) qui appellera l'API et récupérera les données.</li>
                            <li style="margin-bottom: 0.8rem;"><b>Données renvoyées :</b> L'API répond au format JSON. 
                                Pour Paris, elle retournera une structure contenant le pays, l'état (région) et un tableau des lieux ("places") avec leurs codes postaux.</li>
                            <li style="margin-bottom: 0.8rem;"><b>Stockage dans le Lakehouse :</b> Les données récupérées pour chaque ville seront ensuite stockées dans une table de votre Lakehouse, 
                                            ce qui vous permettra de les exploiter facilement par la suite (analyse, visualisation, etc.).</li>
                        </ul>

                        <figure class="image-container">
                            <img src="../assets/images/mf-foreach-activity/schema-foreach.png" 
                                 alt="Schema explicatif du scénario d'illustration de l'activité ForEach"
                                 class="tutorial-image">
                            <figcaption><i>Schema explicatif du scénario d'illustration de l'activité ForEach</i></figcaption>
                        </figure>
                </section>

                <!-- Section: Création d'un Workspace -->
                <section id="create-workspace" class="tutorial-section">
                    <h2><i class="fas fa-upload"></i> Création d'un Workspace</h2>
 
                        <p>La première étape consiste à créer un <b>Workspace</b> dans <b>Microsoft Fabric</b>.</p>

                        <p>Un <b>Workspace</b> est un environnement de travail collaboratif qui permet de regrouper des ressources, des données et des pipelines de données.</p>
                        <p>Pour créer un <b>Workspace</b>, suivez les étapes suivantes :</p>

                        <ol style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                            <li style="margin-bottom: 0.8rem;">Cliquer sur <b>Home</b> depuis la volet gauche de l'interface de <b>Microsoft Fabric</b></li>
                            <li style="margin-bottom: 0.8rem;">Cliquer sur l'icône <b>+ New Workspace</b></li>
                            <li style="margin-bottom: 0.8rem;">Dans le volet droit qui s'ouvre, entrer un nom dans le champ <b>Name</b>. Ici nous allons nommer ce <b>Workspace</b> : <i>TutorielLookupActivity</i>.</li>
                            <li style="margin-bottom: 0.8rem;">Entrer une description dans le champ Description [<i>Optionnel</i>]</li>
                            <li style="margin-bottom: 0.8rem;">Cliquer sur le bouton <b>Apply</b> pour lancer la création du <b>Workspace</b></li>
                        </ol>      
                    
                        <figure class="image-container">
                            <img src="../assets/images/mf-foreach-activity/create-workspace.png" 
                                 alt="Création d'un Workspace dans Microsoft Fabric"
                                 class="tutorial-image">
                            <figcaption><i>Création d'un Workspace dans Microsoft Fabric</i></figcaption>
                        </figure>
                </section>

                <!-- Section: Création d'un Lakehouse -->
                <section id="#create-lakehouse" class="tutorial-section">
                    <h2><i class="fas fa-file-upload"></i> Création d'un Lakehouse</h2>
                        <p>La première étape de notre scénario consiste à créer un <b>Lakehouse</b> dans <b>Microsoft Fabric</b>. </p>

                        <p>Depuis l'interface de votre <b>Workspace</b> <b>Microsoft Fabric</b>, suivre les étapes suivantes :

                        <ol style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                            <li style="margin-bottom: 0.8rem;">Cliquer sur l'icône <b>+ New item</b></li>
                            <li style="margin-bottom: 0.8rem;">Dans le champ de recherche, taper le mot : <i>lakehouse</i></li>
                            <li style="margin-bottom: 0.8rem;">Cliquer sur l'item <b>Lakehouse</b></li>
                        </ol>

                        <figure  class="image-container">
                            <img src="../assets/images/mf-foreach-activity/create-lakehouse-00.png" 
                                alt="Création d'un Lakehouse dans Microsoft Fabric"
                                class="tutorial-image">
                            <figcaption><i>Création d'un Lakehouse dans Microsoft Fabric - Etape 1</i></figcaption>
                        </figure>

                        <p>Cela va ouvrir une fenêtre permettant de nommer ce<b>Lakehouse</b>en suivant les étapes suivantes : </p>

                        <ol style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                            <li style="margin-bottom: 0.8rem;">Dans le champ Name, entrer un nom pour ce nouveau <b>Lakehouse</b>. Dans notre exemple, nous le nommons <i>Demo_LK</i>.</li>
                            <li style="margin-bottom: 0.8rem;">Dans le champ Location, choisir le <b>Lakehouse</b> à utiliser. Dans cet exemple, notre <b>Lakehouse</b> se nomme <i>Tutoriel Download Extract ZIP</i>.</li>
                        </ol>

                        <figure  class="image-container">
                            <img src="../assets/images/mf-foreach-activity/create-lakehouse-01.png" 
                                alt="Création d'un Lakehouse dans Microsoft Fabric"
                                class="tutorial-image">
                            <figcaption><i>Création d'un Lakehouse dans Microsoft Fabric - Etape 2</i></figcaption>
                        </figure>
                </section>

                <!-- Section: Création d'un Pipeline -->
                <section id="create-pipeline" class="tutorial-section">
                    <h2><i class="fas fa-check-circle"></i>Création d'un Pipeline</h2>
                        <p>La prochaine étape va consister à créer un <b>Pipeline</b> de données. </p>

                        <p>Un <b>Pipeline</b> est une ressource d'orchestration qui permet de créer des workflows de données en assemblant des activités de traitement, de déplacement et de transformation de données.</p>

                        <p>Revenir dans l'interface du <b>Workspace</b> que vous utilisez et suivre les étapes suivantes :</p>   

                        <ol style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                            <li style="margin-bottom: 0.8rem;">Cliquer sur le bouton <b>+ New item</b></li>
                            <li style="margin-bottom: 0.8rem;">Dans le volet droit qui s'ouvre, taper le terme <i>pipeline</i> dans le champ de recherche</li>
                            <li style="margin-bottom: 0.8rem;">Cliquer sur l'icône du <b>Pipeline</b></li>
                        </ol>

                        <figure class="image-container">
                            <img src="../assets/images/mf-foreach-activity/create-pipeline-00.png" 
                                 alt="Création d'un Pipeline dans Microsoft Fabric - Etape 1"
                                 class="tutorial-image">
                            <figcaption><i>Création d'un Pipeline dans Microsoft Fabric - Etape 1</i></figcaption>
                        </figure>
                        
                        <br>
                        <p>Cela va ouvrir la fenêtre qui va permettre de nommer ce <b>Pipeline</b> en suivant les étapes suivantes :</p>   

                        <ol style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                            <li style="margin-bottom: 0.8rem;">Dans la fenêtre <b>New Pipeline</b>, entrer un nom de votre choix dans le champ <b>Name</b>. 
                                Ici nous le nommons <i>Download Extract ZIP File</i></li>
                            <li style="margin-bottom: 0.8rem;">Cliquer sur le bouton <b>Create</b> pour terminer la création du <b>Pipeline</b></li>
                        </ol>


                        <figure class="image-container">
                            <img src="../assets/images/mf-foreach-activity/create-pipeline-01.png" 
                                 alt="Création d'un Pipeline dans Microsoft Fabric - Etape 2"
                                 class="tutorial-image">
                            <figcaption><i>Création d'un Pipeline dans Microsoft Fabric - Etape 2</i></figcaption>

                </section>

                <!-- Section: Paramétrage du Pipeline -->
                <section id="setup-pipeline" class="tutorial-section">
                    <h2><i class="fas fa-bookmark"></i> Paramétrage du Pipeline</h2>
                    
                        <p>Dans cette section, nous allons voir comment paramétrer notre pipeline pour le rendre flexible et réutilisable. 
                            Plutôt que de coder en dur la liste des villes dans l'activité ForEach, nous allons utiliser des paramètres de pipeline qui pourront être modifiés à chaque exécution. </p>

                        <h3> Pourquoi utiliser des paramètres ? </h3>

                        <ul style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                            <li style="margin-bottom: 0.8rem;">Réutiliser le même pipeline avec différentes listes de villes</li>
                            <li style="margin-bottom: 0.8rem;">Centraliser la configuration au niveau du pipeline</li>
                            <li style="margin-bottom: 0.8rem;">Tester facilement avec des jeux de données réduits</li>
                            <li style="margin-bottom: 0.8rem;">Automatiser les exécutions via l'API Fabric ou d'autres orchestrations</li>
                        </ul>

                        <p>Voyons à présent comment créer un paramètre de pipeline dans <b>Microsoft Fabric</b>.
                            Ouvrez l'éditeur du pipeline <b>Microsoft Fabric</b> et cliquez sur une zone vide du canevas 
                            puis suivre les étapes suivantes pour créer un paramètre de type Array qui contiendra la liste des villes à traiter dans notre activité <b>ForEach</b>:
                        </p>

                        <ol style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                            <li style="margin-bottom: 0.8rem;">Dans le panneau des propriétés, allez dans l'onglet <b>Parameters</b></li>
                            <li style="margin-bottom: 0.8rem;">Cliquez sur <b>+ Nouveau</b> pour créer un paramètre</li>
                            <li style="margin-bottom: 0.8rem;">Nommez ce paramètre dans le champ <b>Name</b> <i>api_request</i></li>
                            <li style="margin-bottom: 0.8rem;">Dans le champ <b>Type</b>, sélectionnez <b>Array</b></li>
                            <li style="margin-bottom: 0.8rem;">Dans le champ <b>Default value</b>, entrez la liste des villes au format JSON. 
                                Par exemple, vous pouvez utiliser la liste suivante : 
                        <div class="code-block">
                            <button class="copy-btn"><i class="far fa-copy"></i> Copier</button>
                            <pre>
[
    {"country": "US", "zipcode": "90210"},
    {"country": "DE", "zipcode": "80333"},
    {"country": "ES", "zipcode": "31013"},
    {"country": "FR", "zipcode": "71150"},
    {"country": "JP", "zipcode": "100-0001"},
    {"country": "AU", "zipcode": "2000"}
]
                            </pre>
                        </div>
                            </li>
                        </ol>

                        <figure class="image-container">
                            <img src="../assets/images/mf-foreach-activity/settings-pipeline-01.png" 
                                 alt="Création de Paramètre dans un Pipeline dans Microsoft Fabric - Etape 2"
                                 class="tutorial-image">
                            <figcaption><i>Ajout d'un paramètre dans un Pipeline Microsoft Fabric</i></figcaption>
                        </figure>

                </section>

                <!-- Section: Ajout d'une activité ForEach -->
                <section id="add-foreach-activity" class="tutorial-section">
                    <h2><i class="fas fa-bookmark"></i> Ajout d'une activité ForEach</h2>
                        
                        <p>Maintenant que nous avons créé notre pipeline et que nous avons ajouté un paramètre pour la liste des villes, il est temps d'ajouter une activité <b>ForEach</b> à notre pipeline pour itérer sur cette liste de villes.</p>
                        
                        <h3>Ajout de l'activité ForEach au pipeline</h3>
                            <p>Maintenant que nous avons ajouté l'activité <b>ForEach</b> à notre pipeline, il est temps de la configurer pour qu'elle puisse itérer sur notre liste de villes et appeler l'API Zippopotam.us pour chaque ville.</p>

                            <figure class="image-container">
                                <img src="../assets/images/mf-foreach-activity/add-foreach-activity.png" 
                                    alt="Ajout d'une activité ForEach dans un Pipeline - Microsoft Fabric"
                                    class="tutorial-image">
                                <figcaption><i>Ajout d'une activité ForEach dans un Pipeline - Microsoft Fabric</i></figcaption>
                            </figure>   
                        
                            <p>Nous allons à présent voir comment ajouter une activité<b>ForEach</b> à notre pipeline. 
                                Cette activité permet d'itérer sur une liste d'éléments et d'exécuter une ou plusieurs activités pour chaque élément de la liste.</p>
                </section>

                <!-- Section: Paramétrage de l'activité ForEach -->
                <section id="setup-foreach-activity" class="tutorial-section">
                    <h2><i class="fas fa-bookmark"></i> Paramétrage de l'activité ForEach</h2>

                    <h3>Activité ForEach - Menu General</h3>
                         
                        <ol style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                            <li style="margin-bottom: 0.8rem;">Aller dans le menu <b>General</b></li>
                            <li style="margin-bottom: 0.8rem;">Dans le champ <b>Name</b>, entrer un nom pour l'activité <b>ForEach</b> : <i>Loop-API_Zippopoteam</i></li>
                        </ol>

                        <figure class="image-container">
                            <img src="../assets/images/mf-foreach-activity/foreach-activity-menu-general.png" 
                                 alt="Activité ForEach - Menu Genral"
                                 class="tutorial-image">
                            <figcaption><i>Activité ForEach - Menu Genral</i></figcaption>
                        </figure>   


                    <h3>Activité ForEach - Menu Settings</h3>

                        <p>Depuis le menu Settings, nous allons préciser les items surlesquelles l'activité <b>ForEach</b> doit itérer. 
                            Pour cela, nous allons utiliser la variable de pipeline qui contient la liste des villes.</p>
                        
                        <ol style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                            <li style="margin-bottom: 0.8rem;">Aller dans le menu <b>Settings</b></li>
                            <li style="margin-bottom: 0.8rem;">Cliquer dans le champ <b>Items</b> ce qui va ouvrir le menu d'édition du paramètre</li>
                            <li style="margin-bottom: 0.8rem;">Sélectionner le menu <b>Parameters</b></li>
                            <li style="margin-bottom: 0.8rem;">Visualiser que le paramètre a été ajouté dans le champ </li>
                            <li style="margin-bottom: 0.8rem;">Cliquer sur le bouton <b>OK</b> pour valider l'ajout du paramètre et fermer le volet</li>
                        </ol>

                        <figure class="image-container">
                            <img src="../assets/images/mf-foreach-activity/foreach-activity-menu-settings.png" 
                                 alt="Activité ForEach - Menu Settings"
                                 class="tutorial-image">
                            <figcaption><i>Activité ForEach - Menu Settings</i></figcaption>

                </section>

                <!-- Section: Ajout d'une activité Copy data -->
                <section id="add-copy-data-activity" class="tutorial-section">
                    <h2><i class="fas fa-bookmark"></i> Ajout d'une activité Copy data</h2>
 

                    <p>Pour illustrer l'utilisation de l'activité ForEach, nous allons ajouter une activité <b>Copy data</b>  à l'intérieur de la boucle ForEach.
                        Cette activité <b>Copy data</b>  va être configurée pour appeler l'API Zippopotam.us en utilisant les éléments de la liste (pays et ville) et pour stocker les données de sortie dans une table de notre Lakehouse.
                    </p>

                        <h3>Ajout de l'activité Copy data à l'intérieur de la boucle ForEach</h3>

                            <p>Pour ajouter une activité <b>Copy data</b>  à l'intérieur de la boucle ForEach, 
                                cliquer sur l'icône "crayon" de l'actifité <b>ForEach</b> depuis le canevas du pipeline. 
                                Cela va ouvrir le canevas de la boucle <b>ForEach</b> puis suivre les étapes suivantes : </p>


                            <ol style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                                <li style="margin-bottom: 0.8rem;">Depuis ce canevas, cliquer sur le bouton <b>+</b> pour ajouter une activité à l'intérieur de la boucle ForEach. </li>
                                <li style="margin-bottom: 0.8rem;">Dans le menu qui s'ouvre, sélectionner l'activité <b>Copy data</b> . </li>
                                <li style="margin-bottom: 0.8rem;"> Cela va ajouter une activité <b>Copy data</b>  à l'intérieur de la boucle ForEach</li>
                                <li style="margin-bottom: 0.8rem;"></li>
                            </ol>

                            <figure class="image-container">
                                <img src="../assets/images/mf-foreach-activity/add-copydata-activity.png" 
                                    alt="Ajout d'une activité Copy data à l'intérieur de la boucle ForEach - Microsoft Fabric"
                                    class="tutorial-image">
                                <figcaption><i>Ajout d'une activité Copy data à l'intérieur de la boucle ForEach - Microsoft Fabric</i></figcaption>
                            </figure>


                            <p>Maintenant que nous avons ajouté l'activité <b>Copy data</b>  à l'intérieur de la boucle ForEach, il est temps de la configurer pour qu'elle puisse appeler l'API Zippopotam.us en utilisant les éléments de la liste (pays et ville) et pour stocker les données de sortie dans une table de notre Lakehouse.</p>

                        <h3>Paramétrage de l'activité Copy data - Menu General</h3>

                            <p>Dans le menu General de l'activité <b>Copy data</b> , nous allons simplement donner un nom à cette activité.</p>

                            <ol style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                                <li style="margin-bottom: 0.8rem;">Dans le champ <b>Name</b>, entrer un nom pour cette activité. 
                                    Nous allons la nommer <i>Copy data - API Zippopotam</i></li>
                            </ol>

                            <figure class="image-container">
                                <img src="../assets/images/mf-foreach-activity/copydata-menu-general.png" 
                                    alt="Paramétrage de l'activité Copy data - Menu General"
                                    class="tutorial-image">
                                <figcaption><i>Paramétrage de l'activité Copy data - Menu General</i></figcaption>
                            </figure>

                        <h3>Paramétrage de l'activité Copy data - Menu Source</h3>

                            <p>Dans le menu Source de l'activité <b>Copy data</b>, nous allons configurer la source de données pour appeler l'<i>API Zippopotam.us</i>. 
                                Nous allons utiliser une connexion de type <i>"HTTP"</i> pour faire cet appel API. 
                                Voici comment rélaiser cela étape par étape : </p>

                            <ol style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                                <li style="margin-bottom: 0.8rem;">Aller dans le menu <b>Source</b> de l'activité <b>Copy data</b> </li>
                                <li style="margin-bottom: 0.8rem;">Cliquer dans le champ <b>Connection</b></li>
                            <li style="margin-bottom: 0.8rem;">Dans le menu déroulantqui s'ouvre, choisir l'option <b>Browse all</b></li>
                            </ol>

                            <figure class="image-container">
                                <img src="../assets/images/mf-foreach-activity/copydata-menu-source-00.png" 
                                    alt="Paramétrage de l'activité Copy data - Menu Source - Etape 1"
                                    class="tutorial-image">
                                <figcaption><i>Paramétrage de l'activité Copy data - Menu Source - Etape 1</i></figcaption>
                            </figure>

                            <p>Dans la fenêtre qui s'ouvre, vous allez pouvoir créer une nouvelle connexion HTTP :  </p>

                            <ol style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                                <li style="margin-bottom: 0.8rem;">Dans la fenêtre qui vient de s'ouvrir, taper le terme <i>HTTP</i></li>
                                <li style="margin-bottom: 0.8rem;">Cliquer sur l'option <b>HTTP</b></li>
                            </ol>

                            <figure class="image-container">
                                <img src="../assets/images/mf-foreach-activity/copydata-menu-source-01.png" 
                                    alt="Paramétrage de l'activité Copy data - Menu Source - Etape 2"
                                    class="tutorial-image">
                                <figcaption><i>Paramétrage de l'activité Copy data - Menu Source - Etape 2</i></figcaption>
                            </figure>
                            
                            <p>Dans la fenêtre de création de la connexion HTTP, il va falloir renseigner les champs suivants : </p>

                            <ol style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                                <li style="margin-bottom: 0.8rem;">Entre l'URL de l'API Zippopotam.us : <i>https://api.zippopotam.us</i>. Laisser les autres champs vides.</li>
                                <li style="margin-bottom: 0.8rem;">Cliquer sur le bouton <b>Connect</b> por fermer la fenêtre.</li>
                            </ol>

                            <figure class="image-container">
                                <img src="../assets/images/mf-foreach-activity/copydata-menu-source-02.png" 
                                    alt="Paramétrage de l'activité Copy data - Menu Source - Etape 3"
                                    class="tutorial-image">
                                <figcaption><i>Paramétrage de l'activité Copy data - Menu Source - Etape 3</i></figcaption>
                            </figure>

                            <p>Maintenant que la connexion HTTP est créée, il est temps de configurer le champ <b>Relative URL</b> pour faire l'appel dynamique à l'API en utilisant les éléments de la liste (pays et ville) grâce à la variable système @item() : </p>

                            <ol style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                                <li style="margin-bottom: 0.8rem;">Dans le champ <b>Relative URL</b>, entrez la valeur suivante : <i>/@{item().country}/@{item().zipcode}</i>
                                
                                                            <div class="code-block">
                                <button class="copy-btn"><i class="far fa-copy"></i> Copier</button>
                                <pre>
@concat(item().country, '/', item().zipcode)
                                </pre>
                            </div>
                            Cela va permettre de faire un appel dynamique à l'API Zippopotam.us en utilisant les éléments de la liste (pays et ville) grâce à la variable système @item() qui référence l'élément courant de l'itération dans la boucle ForEach.
                                </li>
                                <li style="margin-bottom: 0.8rem;">Dans la champ File format, sélectionnez <b>JSON</b> depuis le menu déroulant. </li>
                            </ol>

                            <figure class="image-container">
                                <img src="../assets/images/mf-foreach-activity/copydata-menu-source-03.png" 
                                    alt="Paramétrage de l'activité Copy data - Menu Source - Etape 4"
                                    class="tutorial-image">
                                <figcaption><i>Paramétrage de l'activité Copy data - Menu Source - Etape 4</i></figcaption>
                            </figure>

                        <h3>Paramétrage de l'activité Copy data - Menu Destination</h3>   
                        
                            <p>Dans le menu Destination de l'activité <b>Copy data</b>, nous allons configurer la destination de données pour stocker les données de sortie de 
                                l'API Zippopotam.us dans une table de notre Lakehouse.</p>

                             <ol style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                                <li style="margin-bottom: 0.8rem;">Aller dans le menu <b>Destination</b></li>
                                <li style="margin-bottom: 0.8rem;">Depuis le champ <b>Lakehouse</b>, sélectionnez l'option <b>Lakehouse</b>.</li>
                                <li style="margin-bottom: 0.8rem;">Dans le champ <b>Lakehouse</b> qui apparaît, sélectionnez le <b>Lakehouse</b> que vous avez créé précédemment dans ce tutoriel : <i>TutorielForEacch_LK</i></li>
                                <li style="margin-bottom: 0.8rem;">Dans le champ <b>Root folder</b>, sélectionner l'option <b>Files</b></li>
                                <li style="margin-bottom: 0.8rem;">Dans le champ <b>File path</b>, vous allez pouvoir renseigner le nom du dossier de stockage (<i>@item().country</i>) et le nom du fichier de sortie : <i>@concat(item().country, '/', item().zipcode, '.json')</i>.</li>
                                <li style="margin-bottom: 0.8rem;">Dans le champ <b>File format</b>, sélectionnez <b>JSON</b> depuis le menu déroulant.</li>
                            </ol>                               

                             <figure class="image-container">
                                <img src="../assets/images/mf-foreach-activity/copydata-menu-destination.png" 
                                    alt="Paramétrage de l'activité Copy data - Menu Destination"
                                    class="tutorial-image">
                                <figcaption><i>Paramétrage de l'activité Copy data - Menu Destination</i></figcaption>
                            </figure>    
                            
                </section>

                <!-- Section: Exécution du Pipeline -->
                <section id="run-pipeline" class="tutorial-section">
                    <h2><i class="fas fa-play-circle"></i> Exécution du Pipeline</h2>
                    
                        <p>Maintenant que nous avons configuré notre pipeline avec une activité <b>ForEach</b> qui itère sur une liste de villes et qui appelle l'API Zippopotam.us pour chaque ville, 
                            il est temps d'exécuter ce pipeline pour voir les résultats.</p>

                             <ol style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                                <li style="margin-bottom: 0.8rem;">Depuis l'interface du Pipeline, aller dans le menu Home</li>
                                <li style="margin-bottom: 0.8rem;">Cliquer sur le bouton <b>Run</b></li>
                                <li style="margin-bottom: 0.8rem;">Vérifier l'état de l'exécution du pipeline dans la section <b>Output</b></li>
                            </ol>

                        <p>On observe que les appels à l'API Zippopotam.us sont été effectués en parallèle.</p>

                        <figure class="image-container">
                            <img src="../assets/images/mf-foreach-activity/run-pipeline.png" 
                            alt="Exécution du pipeline"
                            class="tutorial-image">
                            <figcaption><i>Exécution du pipeline</i></figcaption>
                        </figure> 
                    
                        <p>Une fois l'exécution du pipeline terminée, vous pouvez aller vérifier dans votre <b>Lakehouse</b> que les données de sortie de l'API Zippopotam.us ont bien été stockées dans les fichiers de destination que nous avions configurés dans l'activité <b>Copy data</b> .</p>
                        
                        <ol style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                                <li style="margin-bottom: 0.8rem;">Depuis l'Explorer de fichier du Lakehouse, sélectionner un des dossiers de destination portant un des codez pays présentant dans les items.</li>
                                <li style="margin-bottom: 0.8rem;">Vérifier que les fichiers de données sont bien présents dans le dossier sélectionné portant le nom du code postal intérogé. Le fichier contient les données de sortie de l'API Zippopotam.us pour ce code postal au format JSON.</li>
                                <li style="margin-bottom: 0.8rem;">Vérifier l'état de l'exécution du pipeline dans la section <b>Output</b></li>
                        </ol>   

                        <figure class="image-container">
                            <img src="../assets/images/mf-foreach-activity/view-lakehouse.png" 
                            alt="Visualisation du Lakehouse"
                            class="tutorial-image">
                            <figcaption><i>Visualisation du Lakehouse</i></figcaption>
                        </figure> 
                </section>

              